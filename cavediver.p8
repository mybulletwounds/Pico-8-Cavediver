pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
--Cave Diver
--by mybulletwounds


function _init()
    game_over = false
    music(0)
    make_cave()
    make_player()
end

function _update()
    if (not game_over) then
        update_cave()
        move_player()
        check_hit()
    else
        if (btn(5)) _init() --restart
    end
end

function _draw()
    cls()
    draw_cave()
    draw_player()
    if (game_over) then
        print("game over!",44,44,7)
        print("your score: "..player.score,34,54,7)
        print("press button to play again!" ,18,72,6)
    else
        print("score:"..player.score,2,2,7)
    end

end

function make_player()
    player={}
    player.x = 24 --position
    player.y = 60
    player.dy = 0 --fall speed
    player.rise = 1 --sprites
    player.fall = 2
    player.dead = 3
    player.speed = 2 --flyspeed
    player.score = 0
end

function draw_player()
    if(game_over) then
        spr(player.dead,player.x,player.y)
    elseif (player.dy<0) then
        spr(player.rise,player.x,player.y)
    else
        spr(player.fall, player.x, player.y)
    end

end

function move_player()
    gravity = 0.2 
    player.dy += gravity 

    --jump
    if (btnp(2)) then
        player.dy -=5
        sfx(0)
    end

    --move
    player.y += player.dy
    --update score
    player.score += player.speed

end

function make_cave()
    cave = {{["top"]=5,["btm"]=119}}
    top=45
    btm =85
end

function update_cave()
    --remove
    if (#cave>player.speed) then
        for i=1, player.speed do 
            del(cave,cave[1])
        end
    end

    --add
    while (#cave<128) do
        local col ={}
        local up = flr(rnd(7)-3)
        local dwn=flr(rnd(7)-3)
        col.top=mid(3,cave[#cave].top+up, top)
        col.btm=mid(btm,cave[#cave].btm+dwn,124)
        add(cave,col)
    end
end

function draw_cave()
    top_color=5
    btm_color=5
    for i=1, #cave do
        line(i-1,0,i-1,cave[i].top, top_color)
        line(i-1,127,i-1,cave[i].btm, btm_color)
    end

end

function check_hit()
    for i = player.x,player.x+7 do
        if (cave[i+1].top> player.y or cave[i+1].btm< player.y+7) then
            game_over = true
            sfx(1)
        end
    end
end


__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007776000077760000888e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700007070000070700000808000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000007776000070700000888e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000007706000077060000880e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000770000007700000088000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55577557755775777577755555775577757575555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55755575557575757575555755575575557575555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55777575557575775577555555575577757775555555555555555555555555555555555555555555555555555555550555555555005005555005555555005000
55557575557575757575555755575555755575555555555055555555555555555555555555555555555555555555550055555550000005500005555555000000
55775557757755757577755555777577755575555555555055555555555555555555555555555555555555555555550005055550000000500005055550000000
55555555555555555555555555555555555555555555055055555555555555555555555550555555555555555555500005055500000000500000000050000000
55555555555555555555555555555555555555555550050005555555555555555555555500055055555555555555000005005500000000000000000000000000
55555555505555555555555555555555555555555550000005555555555555555555555500055055555555555555000000000000000000000000000000000000
55555555505555555555505555555555550555555500000005550555550555555555555000050055505555555555000000000000000000000000000000000000
55555555505055555555505555055555550555555000000000550055550055555555555000000005000555555550000000000000000000000000000000000000
55555555000055555555500555055555000550555000000000050050500005555555550000000005000055555500000000000000000000000000000000000000
05555555000005555555000550055555000000050000000000000050000000555555550000000005000055505500000000000000000000000000000000000000
05555555000005555005000050000550000000050000000000000000000000555550000000000000000055505500000000000000000000000000000000000000
05055000000005050000000000000500000000000000000000000000000000555050000000000000000000005000000000000000000000000000000000000000
00050000000000050000000000000000000000000000000000000000000000055000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000055000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000777600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000770600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055500050000055000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000555500055000055005550050000000000000000
00000000000000000000000000000000000000000000000000000000000000050000000000000000000000000555550555050555005550555000000000000000
00000000000000000000000000000000000000000000000000000000000000550000000000000000000000005555555555550555555550555500000000000000
00000000000000000000000000000000000000000000000000000000000000550000000000000000000000005555555555550555555555555550000000000000
00000000050000000000000000000500000000000000000000000000000055555000000000000000000000005555555555555555555555555555000000000005
00000050050000000500005000000550000000000000000000000000000055555000000000000000000000055555555555555555555555555555050000000055
00000050550000005500005000000550000000005000000000000000000055555000000000000000000000555555555555555555555555555555555555000055
00005050555505055500005500005550550050505000000000000000000555555500000000000000000000555555555555555555555555555555555555050555
00005555555555555550055555055555555550505000000000000000000555555500000000000000000000555555555555555555555555555555555555050555
00005555555555555555555555055555555550555500000000000000005555555550000000000000000005555555555555555555555555555555555555555555
00055555555555555555555555555555555555555500000000000000055555555550000000000000000555555555555555555555555555555555555555555555
00055555555555555555555555555555555555555550000000000000055555555550000000000000000555555555555555555555555555555555555555555555
00055555555555555555555555555555555555555550000000000000055555555555000000000000005555555555555555555555555555555555555555555555
00555555555555555555555555555555555555555555000000000000555555555555000000000055505555555555555555555555555555555555555555555555
00555555555555555555555555555555555555555555500000000000555555555555050000000055505555555555555555555555555555555555555555555555
00555555555555555555555555555555555555555555500000000000555555555555550000050055555555555555555555555555555555555555555555555555
05555555555555555555555555555555555555555555505000000055555555555555550000055555555555555555555555555555555555555555555555555555
05555555555555555555555555555555555555555555555005000055555555555555555000555555555555555555555555555555555555555555555555555555
05555555555555555555555555555555555555555555555505055555555555555555555550555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555

__sfx__
000400000e05012050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000a00002905000000210500000019050000000000007040070200702007020070100701006010070100701007010000000000000000000000705000000120000000000000000000000000000000000000000000
000f00000102503025030250302501015030150301501015030150301502015020150301503015020150201503015050150501504015020150301505015030150301503015040150501505025050250202501025
__music__
02 02424344

